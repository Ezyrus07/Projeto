/* ==========================================================
   DOKE RESPONSIVE (Mobile/Tablet hardening)
   Goal: nothing breaks in 320px phones, tablets (portrait/landscape)
   ========================================================== */

*{ box-sizing:border-box; }
html, body{ max-width:100%; overflow-x:hidden; }
img, video, canvas, svg{ max-width:100%; }

/* Stop old headers/navs from duplicating when Shell is active */
@media (max-width:1024px){
  /* Desktop sidebars / navbars */
  .navbar-desktop, .sidebar, .sidebar-icones, #sidebar, .menu-lateral, .nav-lateral{ display:none !important; }
  /* Legacy bottom navs */
  .bottom-nav, nav.bottom-nav, .mobile-bottom-nav, .menu-bottom, .bottomMenu{ display:none !important; }
}

/* =============================
   PERFIL / STATS (não quebrar)
   ============================= */
@media (max-width:1024px){
  .dp-stats, .perfil-stats, .stats, .stats-grid, .perfil-metrics{
    display:grid !important;
    grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
    gap: 12px !important;
    align-items: stretch !important;
  }
  .dp-stats > *, .perfil-stats > *, .stats > *, .stats-grid > *, .perfil-metrics > *{
    margin: 0 !important;
    min-width: 0 !important;
  }
}
@media (min-width:1025px){
  .dp-stats, .perfil-stats, .stats, .stats-grid, .perfil-metrics{
    display:flex !important;
    flex-wrap: nowrap !important;
    gap: 14px !important;
  }
}

/* =========================================
   CHAT MOBILE (lista -> conversa)
   ========================================= */
@media (max-width:1024px){
  body.mobile-chat-open{ overflow:hidden; }
  body.mobile-chat-open .coluna-chat{ transform: translateX(0) !important; }
}

/* =========================================
   MODAL DE PUBLICAÇÕES (imagem/vídeo + comentários)
   Padrão mais usado: fullscreen no mobile/tablet
   ========================================= */

@keyframes dokeModalFadeIn{ from{opacity:0;} to{opacity:1;} }
@keyframes dokeModalCardIn{ from{transform:translateY(10px) scale(.99); opacity:0;} to{transform:translateY(0) scale(1); opacity:1;} }

@media (max-width:1024px){
  /* Overlay ocupa tudo, sem padding */
  .modal-overlay, .modal-video-overlay{
    padding: 0 !important;
    align-items: stretch !important;
    justify-content: stretch !important;
  }
  /* Quando abrir (display:flex), anima */
  .modal-overlay[style*="display: flex"],
  .modal-overlay[style*="display:flex"],
  .modal-video-overlay[style*="display: flex"],
  .modal-video-overlay[style*="display:flex"]{
    animation: dokeModalFadeIn .14s ease both;
  }

  /* Card vira fullscreen */
  .modal-content, .modal-content-universal{
    width: 100% !important;
    max-width: 100% !important;
    height: 100% !important;
    max-height: 100% !important;
    border-radius: 0 !important;
    flex-direction: column !important;
    animation: dokeModalCardIn .16s ease both;
  }
  /* Área de mídia (topo) */
  .modal-media-area{
    flex: 0 0 44vh !important;
    height: 44vh !important;
    min-height: 240px !important;
  }
  /* Mídia SEM cortar */
  .modal-media-area img, .modal-media-area video{
    width: 100% !important;
    height: 100% !important;
    object-fit: contain !important;
  }
  /* Lado info (comentários) */
  .modal-info-area{
    flex: 1 1 auto !important;
    min-width: 0 !important;
    border-left: none !important;
    display:flex !important;
    flex-direction: column !important;
  }
  /* Lista comentários: scroll interno */
  .modal-comments-section, .modal-comments-list{
    flex: 1 1 auto !important;
    overflow:auto !important;
    -webkit-overflow-scrolling: touch;
  }
  /* Rodapé sticky: input + ações sempre visíveis */
  .modal-footer-actions, .modal-actions, .modal-input-area{
    position: sticky !important;
    bottom: 0 !important;
    background: #fff !important;
    z-index: 2 !important;
  }
}

/* Gallery fullscreen (mobile) */
@media (max-width:1024px){
  #modalGaleria .galeria-container, #modalGaleria .galeria-content{
    width: 100% !important;
    max-width: 100% !important;
    height: 100% !important;
    border-radius: 0 !important;
  }
}


/* =========================
   REVEAL FAILSAFE (HOME)
   Evita ficar tudo invisível no mobile se o IntersectionObserver não disparar.
   Só anima quando o JS marca body com .reveal-enabled.
   ========================= */
@media (max-width:1024px){
  body[data-page="home"] .reveal,
  body[data-page="home"].reveal-enabled .reveal,
  body[data-page="home"].reveal-enabled .reveal.is-visible{
    opacity: 1 !important;
    transform: none !important;
    transition: none !important;
  }

  body[data-page="home"] .main-footer{
    margin-left: 0 !important;
    width: 100% !important;
  }

  /* Evita "blocos vazios" no index mobile causados por content-visibility */
  body[data-page="home"] .categorias-container,
  body[data-page="home"] .videos-container,
  body[data-page="home"] .fotos-container,
  body[data-page="home"] .anuncio-container,
  body[data-page="home"] .para-voce-section,
  body[data-page="home"] .pros-section,
  body[data-page="home"] .rodape-container,
  body[data-page="home"] .rodape-container2{
    content-visibility: visible !important;
    contain-intrinsic-size: auto !important;
  }
}

/* ============================================================
   MOBILE/TABLET POLISH (layout stability + spacing)
   ============================================================ */
@media (max-width:1024px){
  :root{ --doke-mobile-gutter: 14px; }

  main, .dp-wrap{
    width: 100%;
    max-width: 100%;
    box-sizing: border-box;
    padding: 12px var(--doke-mobile-gutter) calc(var(--doke-btm-real, 66px) + 18px + env(safe-area-inset-bottom));
  }

  .secao-busca,
  .categorias-container,
  .videos-container,
  .fotos-container,
  .anuncio-container,
  .para-voce-section,
  .pros-section{
    max-width: 100% !important;
    margin-left: auto;
    margin-right: auto;
  }

  .secao-busca,
  .videos-container,
  .fotos-container,
  .anuncio-container,
  .para-voce-section,
  .pros-section{
    padding: 16px 14px;
    border-radius: 16px;
  }

  .categorias-container.estilo-lojas{
    padding: 10px var(--doke-mobile-gutter);
  }

  .categorias-em-alta,
  .cat-carousel,
  #galeria-dinamica,
  .pros-carousel{
    padding-inline: 6px;
  }

  .filtros-container-premium,
  .filtros-expandidos{
    padding: 14px;
  }

  .filtros-container-premium{
    margin-bottom: 20px;
    border-radius: 14px;
  }

  .filtros-header-row{
    flex-direction: column;
    align-items: flex-start;
    gap: 8px;
  }

  .btn-toggle-filtros{
    width: 100%;
    justify-content: center;
  }

  .grid-loc,
  .grid-extras{
    grid-template-columns: 1fr !important;
    gap: 10px !important;
  }

  .botoes-busca,
  .filtros-rapidos{
    gap: 10px;
  }

  .filtros-chips-scroll{
    gap: 6px;
    padding-bottom: 2px;
    flex-wrap: nowrap;
    align-items: center;
    min-width: 0;
  }

  .chip-tag{
    font-size: 0.78rem;
    padding: 6px 10px;
    border-radius: 999px;
    border: none;
    background: #f3f4f6;
    color: #4b5563;
    max-width: clamp(90px, 22vw, 140px);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    box-shadow: none;
  }
  .chip-tag i{ font-size: 0.95rem; }
  .chip-tag.ativo{
    background: var(--cor0);
    color: #fff;
  }

  /* Home: quick filters should never wrap or overflow */
  body[data-page="home"] .filtros-container-premium{
    margin-bottom: 16px;
    border: 0;
    box-shadow: none;
  }
  body[data-page="home"] .filtros-rapidos{
    gap: 8px;
  }
  body[data-page="home"] .filtros-rapidos-header{
    gap: 8px;
    align-items: center;
  }
  body[data-page="home"] .filtros-chips-scroll{
    gap: 6px;
    padding: 2px 2px 0;
    overflow-x: auto;
    overflow-y: hidden;
    -webkit-overflow-scrolling: touch;
  }
  body[data-page="home"] .filtros-rapidos .chip-tag{
    flex: 0 0 auto !important;
    border: 0 !important;
    box-shadow: none !important;
    padding: 6px 10px !important;
    font-size: 0.78rem !important;
    max-width: clamp(88px, 26vw, 150px);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  /* Home: anuncios/cards proportion on mobile */
  body[data-page="home"] .lista-cards-premium{
    grid-template-columns: 1fr !important;
    gap: 16px !important;
  }
  body[data-page="home"] .card-premium,
  body[data-page="home"] .anuncio-card{
    width: 100% !important;
    max-width: 100% !important;
    margin: 0 !important;
  }
  body[data-page="home"] .cp-header,
  body[data-page="home"] .cp-body,
  body[data-page="home"] .cp-footer,
  body[data-page="home"] .cp-header-clean,
  body[data-page="home"] .cp-footer-right{
    padding-left: 16px !important;
    padding-right: 16px !important;
  }
  body[data-page="home"] .cp-carousel,
  body[data-page="home"] .cp-media-grid,
  body[data-page="home"] .grid-fotos-doke,
  body[data-page="home"] .skeleton-premium-cover{
    height: 220px !important;
  }
  body[data-page="home"] .grid-fotos-doke{
    grid-template-rows: 1fr 1fr;
  }

  /* Home: anuncio-card grid proportions */
  body[data-page="home"] .anuncio-card .media-grid{
    grid-template-columns: 2fr 1fr !important;
    grid-template-rows: 120px 120px !important;
  }
  body[data-page="home"] .anuncio-card .media-item-main{
    grid-column: 1 / 2 !important;
    grid-row: 1 / 3 !important;
  }
  body[data-page="home"] .anuncio-card .media-item-sub{
    display: block !important;
  }
  body[data-page="home"] .anuncio-card .media-grid .media-img{
    border-radius: 0;
  }
  body[data-page="home"] .anuncio-card .card-header,
  body[data-page="home"] .anuncio-card .card-body,
  body[data-page="home"] .anuncio-card .card-footer{
    padding-left: 16px !important;
    padding-right: 16px !important;
  }
  body[data-page="home"] .anuncio-card .btn-action-card{
    padding: 10px 18px;
    font-size: 0.82rem;
  }

  .btn-procurar,
  .btn-anunciar,
  .btn-aplicar{
    width: 100%;
  }

  .footer-content{
    grid-template-columns: 1fr !important;
    text-align: center;
  }

  .footer-bottom{
    flex-direction: column;
    text-align: center;
    gap: 10px;
  }
}

@media (max-width:600px){
  .sec-title{ font-size: 1.2rem; }
  .typing-container{ font-size: 16px; }
  .btn-procurar, .btn-anunciar{ font-size: 0.95rem; }
}

@media (max-width:480px){
  body[data-page="home"] .filtros-rapidos .chip-tag{
    font-size: 0.72rem !important;
    padding: 6px 8px !important;
    max-width: clamp(86px, 30vw, 140px);
  }
  body[data-page="home"] .filtros-rapidos .chip-tag i{
    display: none;
  }
  .doke-mobile-header .profile-img-btn,
  .doke-mobile-header .doke-avatar,
  .doke-mobile-header .doke-avatar-btn{
    width: 38px !important;
    height: 38px !important;
  }
  .doke-mobile-header .profile-img-btn,
  .doke-mobile-header .doke-avatar{
    border: 0 !important;
    box-shadow: none !important;
  }
  .doke-mobile-header .doke-avatar-btn{
    border: 1px solid rgba(2,6,23,.1) !important;
  }
}
