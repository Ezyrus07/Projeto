<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meu Painel | Doke Profissional</title>
    <link rel="stylesheet" href="style.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="module" src="script.js"></script>
    <style>
        /* ==========================================================================
           ESTILOS GERAIS
           ========================================================================== */
        .perfil-main { margin-left: 270px; margin-right: 20px; max-width: 1600px; width: auto; padding-bottom: 60px; }
        .perfil-header-card { background: #fff; border-radius: 16px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); overflow: hidden; margin-bottom: 30px; }
        .capa-perfil { height: 180px; background: linear-gradient(120deg, var(--cor2), #8e44ad); position: relative; }
        .btn-edit-capa { position: absolute; right: 20px; bottom: 20px; background: rgba(0,0,0,0.5); color: white; border: none; padding: 8px 15px; border-radius: 6px; cursor: pointer; font-size: 0.85rem; display: flex; align-items: center; gap: 6px; transition: 0.2s; }
        .dados-perfil { padding: 0 30px 20px 30px; display: flex; flex-wrap: wrap; align-items: flex-end; gap: 30px; margin-top: -50px; }
        .avatar-container { position: relative; flex-shrink: 0; }
        .avatar-container img { width: 140px; height: 140px; border-radius: 50%; border: 5px solid #fff; object-fit: cover; background: #fff; }
        .status-online { width: 20px; height: 20px; background: #2ecc71; border: 3px solid #fff; border-radius: 50%; position: absolute; bottom: 15px; right: 10px; }
        .info-texto { flex: 1; margin-top: 60px; min-width: 250px; }
        .nome-row { display: flex; align-items: center; gap: 10px; margin-bottom: 5px; }
        .nome-row h1 { font-size: 1.6rem; color: #333; margin: 0; display:flex; align-items:center; gap:5px; }
        .social-stats { display: flex; gap: 25px; margin: 12px 0 15px 0; }
        .stat-social { display: flex; flex-direction: column; align-items: flex-start; cursor: pointer; }
        .stat-social strong { font-size: 1.1rem; color: #333; font-weight: 800; }
        .stat-social span { font-size: 0.85rem; color: #777; }
        .bio { color: #666; font-size: 0.95rem; margin: 8px 0 15px 0; line-height: 1.4; }
        .meta-dados { display: flex; gap: 20px; flex-wrap: wrap; font-size: 0.85rem; color: #777; }
        .acoes-perfil { display: flex; flex-direction: column; align-items: flex-end; gap: 10px; padding-top: 60px; }
        .btn-solid { background: var(--cor0); color: white; border: none; padding: 10px 25px; border-radius: 30px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 8px; transition: 0.2s; }
        .btn-solid:hover { background: #096356; transform: translateY(-2px); }
        .toggle-disponivel { display: flex; align-items: center; gap: 10px; font-size: 0.9rem; font-weight: 600; color: #555; margin-bottom: 5px; }

        /* DESTAQUES & ABAS */
        .area-destaques-container { padding: 10px 30px 30px 30px; border-top: 1px solid #f5f5f5; margin-top: 10px; }
        .scroll-destaques { display: flex; gap: 18px; overflow-x: auto; padding-bottom: 10px; scrollbar-width: none; }
        .item-destaque { display: flex; flex-direction: column; align-items: center; cursor: pointer; min-width: 70px; }
        .circulo-destaque { width: 68px; height: 68px; border-radius: 50%; padding: 3px; border: 1px solid #ddd; margin-bottom: 8px; transition: transform 0.2s ease; }
        .circulo-destaque img { width: 100%; height: 100%; border-radius: 50%; object-fit: cover; }
        .circulo-destaque.add { border: 2px dashed #ccc; display: flex; align-items: center; justify-content: center; background: #fafafa; }
        .tabs-container { border-bottom: 1px solid #e0e0e0; margin-bottom: 25px; display: flex; gap: 30px; overflow-x: auto; }
        .tab-btn { background: none; border: none; padding: 10px 5px; font-size: 1rem; color: #777; font-weight: 600; cursor: pointer; border-bottom: 3px solid transparent; transition: 0.3s; white-space: nowrap; }
        .tab-btn.active { color: var(--cor2); border-bottom-color: var(--cor2); }
        .tab-content { display: none; animation: fadeIn 0.4s; }
        .tab-content.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* KPIS & GR√ÅFICOS */
        .painel-stats-geral { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px; }
        .card-kpi { background: #fff; padding: 20px; border-radius: 12px; border: 1px solid #eee; text-align: center; }
        .card-kpi h3 { font-size: 1.8rem; color: #333; margin: 0; }
        .text-success { color: #2ecc71; } .text-danger { color: #e74c3c; }
        .charts-grid { display: grid; grid-template-columns: 2fr 1fr; gap: 20px; margin-bottom: 30px; }
        .chart-card { background: #fff; padding: 20px; border-radius: 12px; border: 1px solid #eee; height: 320px; display: flex; flex-direction: column; }
        .chart-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .canvas-container { flex: 1; position: relative; width: 100%; height: 100%; overflow: hidden; }

        /* LISTA DE AN√öNCIOS */
        .anuncio-stats-card { background: #fff; border: 1px solid #e0e0e0; border-radius: 12px; padding: 15px; display: flex; gap: 20px; margin-bottom: 15px; align-items: center; }
        .img-anuncio-mini { width: 100px; height: 100px; border-radius: 8px; object-fit: cover; }
        .info-anuncio-stats { flex: 1; }
        .topo-anuncio { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .badge-status { font-size: 0.75rem; font-weight: 700; padding: 4px 10px; border-radius: 20px; }
        .badge-status.ativo { background: #e8f5e9; color: #2e7d32; }
        .badge-status.pausado { background: #fff3e0; color: #ef6c00; }
        .grid-metricas-anuncio { display: flex; gap: 25px; }
        .metrica { display: flex; align-items: center; gap: 8px; font-size: 0.9rem; }
        .acoes-anuncio-stats { display: flex; flex-direction: column; gap: 8px; }
        .btn-boost { background: linear-gradient(90deg, #ff9800, #f57c00); color: white; border: none; padding: 8px 15px; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: 0.85rem; display: flex; gap: 5px; align-items: center; }
        .btn-icon-stats { background: #f5f5f5; border: none; padding: 8px; border-radius: 6px; cursor: pointer; color: #555; }

        /* === ESTILOS RESTAURADOS: FEED (CRIAR POST) === */
        .box-criar-post { background: #fff; border: 1px solid #e0e0e0; border-radius: 12px; padding: 20px; margin-bottom: 20px; }
        .topo-criar { display: flex; gap: 15px; margin-bottom: 15px; }
        .avatar-mini { width: 45px; height: 45px; border-radius: 50%; object-fit: cover; }
        .topo-criar textarea { flex: 1; border: none; resize: none; outline: none; font-family: var(--fonte-padrao); font-size: 1rem; color: #333; padding-top: 10px; height: 60px; }
        .bottom-criar { display: flex; justify-content: space-between; align-items: center; border-top: 1px solid #f0f0f0; padding-top: 15px; }
        .opcoes-midia { display: flex; gap: 10px; }
        .btn-midia { background: transparent; border: none; cursor: pointer; display: flex; align-items: center; gap: 6px; font-weight: 600; font-size: 0.9rem; }
        .btn-midia.foto { color: #2ecc71; }
        .btn-midia.video { color: #e74c3c; }
        .btn-midia.story { color: #9b59b6; border: 1px dashed #9b59b6; padding: 5px 10px; border-radius: 20px; }
        .btn-publicar { background: var(--cor2); color: white; border: none; padding: 8px 20px; border-radius: 20px; font-weight: 600; cursor: pointer; }
        .post-feed-card { background: #fff; border: 1px solid #e0e0e0; border-radius: 12px; margin-top: 20px; overflow: hidden; }
        .header-post { padding: 15px; display: flex; justify-content: space-between; align-items: center; }
        .user-post { display: flex; gap: 10px; align-items: center; }
        .user-post img { width: 40px; height: 40px; border-radius: 50%; }
        .legenda-post { padding: 0 15px 15px 15px; margin: 0; font-size: 0.95rem; color: #333; }
        .midia-post img { width: 100%; height: auto; display: block; }
        .stats-post { padding: 15px; border-top: 1px solid #f0f0f0; display: flex; gap: 20px; color: #666; font-size: 0.85rem; font-weight: 600; }

        /* === ESTILOS RESTAURADOS: PORTF√ìLIO === */
        .portfolio-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; padding: 10px 0; }
        .card-portfolio { background: #fff; border-radius: 12px; border: 1px solid #eee; overflow: hidden; transition: transform 0.3s, box-shadow 0.3s; cursor: pointer; }
        .card-portfolio:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.08); }
        .portfolio-thumb { width: 100%; height: 180px; object-fit: cover; }
        .portfolio-body { padding: 15px; }
        .portfolio-tags { display: flex; gap: 8px; margin-bottom: 10px; }
        .tag-pf { background: #f0f0f0; color: #666; font-size: 0.7rem; padding: 3px 8px; border-radius: 4px; font-weight: 600; }
        .portfolio-body h4 { margin: 0 0 5px 0; font-size: 1.1rem; color: #333; }
        .portfolio-body p { margin: 0; font-size: 0.85rem; color: #777; line-height: 1.4; }
        .portfolio-footer { padding: 12px 15px; border-top: 1px solid #f5f5f5; display: flex; justify-content: space-between; align-items: center; }
        .btn-ver-projeto { font-size: 0.8rem; font-weight: 700; color: var(--cor0); background: none; border: none; cursor: pointer; }

        /* === ESTILOS RESTAURADOS: AVALIA√á√ïES === */
        .avaliacao-container { background: #fff; padding: 20px; border-radius: 12px; border: 1px solid #f0f0f0; width: 100%; margin-top: 10px; }
        .avaliacao-header { display: flex; align-items: center; margin-bottom: 30px; gap: 20px; }
        .criterios-badge { background-color: #e0f2f1; color: var(--cor0); font-weight: 800; padding: 8px 25px; border-radius: 30px; font-size: 1rem; flex-shrink: 0; width: 200px; text-align: center; }
        .notas-header { background-color: #ecedf2; color: var(--cor2); font-weight: 700; padding: 8px 20px; border-radius: 30px; flex-grow: 1; display: flex; justify-content: space-between; font-size: 0.9rem; }
        .notas-header span { flex: 1; text-align: left; padding-left: 10px; }
        .avaliacao-row { display: flex; align-items: center; padding: 15px 0; gap: 20px; position: relative; border-bottom: 1px solid #f9f9f9; border-left: 4px solid transparent; cursor: pointer; }
        .avaliacao-row:hover { background-color: #fafafa; }
        .avaliacao-row.selecionado { background-color: #e0f2f1; border-left-color: var(--cor0); }
        .criterio-nome { width: 200px; color: var(--cor2); font-weight: 600; display: flex; align-items: center; gap: 10px; font-size: 0.95rem; flex-shrink: 0; }
        .icon-criterio { width: 20px; height: 20px; stroke: #999; }
        .barras-grupo { flex-grow: 1; display: flex; justify-content: space-between; }
        .barra-item { flex: 1; display: flex; align-items: center; gap: 8px; padding-right: 15px; }
        .barra-item .num { color: var(--cor2); font-weight: 700; min-width: 20px; font-size: 0.85rem; }
        .progress { background-color: #f0f0f0; height: 8px; border-radius: 10px; width: 100%; max-width: 60px; overflow: hidden; }
        .progress .fill { background-color: var(--cor0); height: 100%; border-radius: 10px; }
        .tooltip-msgs { display: none !important; }
        #box-detalhes-criterio { background: #fafafa; border: 1px solid #eee; border-radius: 8px; padding: 20px; margin: 20px 0; display: none; animation: fadeIn 0.3s; }
        .msg-destaque-item { background: #fff; padding: 12px; border-radius: 8px; border: 1px solid #e0e0e0; margin-bottom: 10px; color: #555; font-style: italic; box-shadow: 0 2px 5px rgba(0,0,0,0.03); border-left: 3px solid #ccc; }
        .galeria-posts { display: flex; justify-content: space-between; gap: 20px; margin-top: 40px; padding-top: 20px; border-top: 1px solid #f5f5f5; }
        .post-card { background-color: #f9f9f9; border: 1px solid #eee; border-radius: 15px; min-height: 150px; flex: 1; position: relative; padding: 20px; display: flex; flex-direction: column; justify-content: space-between; }
        .user-comment-header { display: flex; align-items: center; gap: 12px; margin-bottom: 10px; }
        .avatar-comment { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; }
        .name-comment { font-size: 0.9rem; font-weight: 700; color: #333; display: flex; flex-direction: column; line-height: 1.2; }
        .conteudo-post { font-size: 0.85rem; color: #555; font-style: italic; line-height: 1.4; }
        .heart-icon { position: absolute; bottom: 15px; right: 15px; font-size: 1.2rem; color: var(--cor0); cursor: pointer; }

        /* MODAL */
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9999; justify-content: center; align-items: center; backdrop-filter: blur(3px); }
        .modal-card { background: #fff; width: 90%; max-width: 500px; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.2); overflow: hidden; animation: zoomIn 0.3s; }
        @keyframes zoomIn { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .modal-header { background: #f9f9f9; padding: 15px 20px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; }
        .modal-body { padding: 20px; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; font-size: 0.9rem; font-weight: 600; color: #555; margin-bottom: 5px; }
        .input-modal { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-family: var(--fonte-padrao); }
        .modal-footer { padding: 15px 20px; background: #fff; border-top: 1px solid #eee; display: flex; justify-content: flex-end; gap: 10px; }
        .btn-cancel { background: #f0f0f0; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: 600; color: #666; }
        .btn-save { background: var(--cor0); border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: 600; color: white; }
        .btn-close-modal { border:none; background:transparent; font-size:1.5rem; cursor:pointer;}

        .custom-file-wrapper { display: flex; align-items: center; gap: 10px; }
        .custom-file-label { display: inline-flex; align-items: center; gap: 8px; padding: 10px 20px; background-color: #f8f9fa; border: 1px solid #ddd; border-radius: 8px; cursor: pointer; color: #555; font-size: 0.9rem; font-weight: 600; transition: 0.2s; }
        .custom-file-label:hover { background-color: #e9ecef; border-color: #ccc; color: #333; }
        .custom-file-label i { font-size: 1.2rem; color: var(--cor0); }
        .file-name { font-size: 0.85rem; color: #888; font-style: italic; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 200px; }

        @media (max-width: 768px) {
            .perfil-main { margin-left: 0; margin-right: 0; padding: 0 0 60px 0; }
            .perfil-header-card { border-radius: 0; border: none; margin-bottom: 15px; }
            .dados-perfil { flex-direction: column; align-items: center; text-align: center; margin-top: -60px; }
            .painel-stats-geral { grid-template-columns: 1fr; }
            .charts-grid { display: flex; flex-direction: column; gap: 20px; height: auto; margin-bottom: 20px; }
            .chart-card { width: 100%; height: auto; min-height: 320px; }
            .anuncio-stats-card { flex-direction: column; align-items: flex-start; }
            .img-anuncio-mini { width: 100%; height: 150px; }
            .acoes-anuncio-stats { flex-direction: row; width: 100%; justify-content: space-between; margin-top: 10px; }
            
            .portfolio-grid { grid-template-columns: 1fr; }
            .avaliacao-header { display: none; }
            .avaliacao-row { flex-direction: column; align-items: flex-start; gap: 15px; padding: 20px; }
            .criterio-nome { width: 100%; justify-content: space-between; border-bottom: 1px solid #eee; padding-bottom: 10px; }
            .barras-grupo { display: grid; grid-template-columns: 1fr 1fr; width: 100%; gap: 10px; }
            .galeria-posts { flex-direction: column; }
        }

        /* --- CSS GALERIA NO MODAL DE EDI√á√ÉO --- */
.galeria-modal-container {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-bottom: 10px;
}

.thumb-wrapper {
    position: relative;
    width: 80px;
    height: 80px;
    border-radius: 8px;
    border: 1px solid #ddd;
    overflow: hidden;
}

.thumb-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.btn-delete-img {
    position: absolute;
    top: 2px;
    right: 2px;
    background: rgba(231, 76, 60, 0.9); /* Vermelho */
    color: white;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 12px;
    font-weight: bold;
    border: none;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    transition: 0.2s;
}

.btn-delete-img:hover {
    background: red;
    transform: scale(1.1);
}


    </style>
</head>
<body>

    <header class="navbar-mobile">
        <div id="logo-mobile">
            <a href="index.html"><img src="assets/Imagens/doke-logo.png" alt="Doke" onerror="this.src='https://placehold.co/100x40?text=Doke'"></a>
        </div>
        <div class="mobile-controls">
            <button id="btn-menu-mobile" onclick="abrirMenuMobile()"><i class='bx bx-menu' style="font-size: 30px; color: var(--cor2);"></i></button>
        </div>
    </header>
    <div id="overlay-menu" onclick="fecharMenuMobile()"></div>

    <aside class="sidebar-icones">
        <div id="logo"><a href="index.html"><img src="assets/Imagens/doke-logo.png" alt="Doke"></a></div>
        <div class="item"><a href="index.html"><img src="https://cdn-icons-png.flaticon.com/512/1946/1946436.png" class="icon azul"><span>In√≠cio</span></a></div>
        <div class="item"><a href="explorar.html"><img src="https://cdn-icons-png.flaticon.com/512/622/622669.png" class="icon verde"><span>Explorar</span></a></div>
        <div class="item"><a href="notificacoes.html"><img src="https://cdn-icons-png.flaticon.com/512/1827/1827392.png" class="icon azul"><span>Notifica√ß√µes</span></a></div>
        <div class="item"><img src="https://cdn-icons-png.flaticon.com/512/561/561127.png" class="icon azul"><a href="chat.html"><span>Mensagens</span></a></div>
        <div class="item"><a href="comunidade.html"><img src="https://cdn-icons-png.flaticon.com/512/1144/1144760.png" class="icon verde"><span>Comunidades</span></a></div>
        <div class="item active"><img src="https://cdn-icons-png.flaticon.com/512/1077/1077114.png" class="icon verde"><a href="meuperfil.html"><span>Perfil</span></a></div>
        <div class="item"><img src="https://cdn-icons-png.flaticon.com/512/56/56763.png" class="icon azul"><a href="mais.html"><span>Mais</span></a></div>
    </aside>

    <header class="navbar-desktop">
        <div id="logo-desktop"><a href="projeto.html"><img src="assets/Imagens/doke-logo.png" alt="Doke"></a></div>
        <nav class="menu">
            <div class="cep-wrapper"><a href="#" class="cep"><span>Informe seu CEP</span></a></div>
            <a href="anunciar.html">Anuncie seu servi√ßo</a>
            <a href="comunidade.html ">Comunidades <span class="badge-novo">NOVO</span></a>
            <a href="novidades.html">Novidades</a>
        </nav>
        <div class="botoes-direita" id="header-user-area">
            <div style="display:flex; align-items:center; gap:10px;">
                <img id="headerAvatar" src="" style="width:35px; height:35px; border-radius:50%; object-fit:cover; display:none;">
            </div>
        </div>
    </header>

    <main class="perfil-main">
        <section class="perfil-header-card">
            <div class="capa-perfil">
                <button class="btn-edit-capa"><i class='bx bx-camera'></i> Editar Capa</button>
            </div>
            <div class="dados-perfil">
                <div class="avatar-container">
                    <img src="" alt="Perfil" id="fotoPerfilDisplay">
                    <div class="status-online"></div>
                </div>
                <div class="info-texto">
                    <div class="nome-row">
                        <h1 id="nomePerfilDisplay">Carregando...</h1>
                    </div>
                    <div class="social-stats">
                        <div class="stat-social"><strong>12.5k</strong><span>Seguidores</span></div>
                        <div class="stat-social"><strong>450</strong><span>Seguindo</span></div>
                        <div class="stat-social"><strong>142</strong><span>Avalia√ß√µes</span></div>
                    </div>
                    <p class="bio" id="bioPerfilDisplay">...</p>
                    <div class="meta-dados">
                        <span id="locPerfilDisplay"><i class='bx bx-map'></i> ...</span>
                        <span><i class='bx bx-calendar'></i> Membro desde 2023</span>
                    </div>
                </div>
                <div class="acoes-perfil">
                    <div class="toggle-disponivel">
                        <span>Dispon√≠vel</span>
                        <label class="switch"><input type="checkbox" checked><span class="slider round"></span></label>
                    </div>
                    <button class="btn-solid" onclick="abrirModalEditar()"><i class='bx bx-pencil'></i> Editar Perfil</button>
                </div>
            </div>
            <div class="area-destaques-container">
                <div class="scroll-destaques">
                    <div class="item-destaque"><div class="circulo-destaque add"><i class='bx bx-plus'></i></div><span>Novo</span></div>
                    <div class="item-destaque"><div class="circulo-destaque"><img src="https://images.unsplash.com/photo-1581092921461-eab62e97a782?q=80&w=200"></div><span>Obras</span></div>
                </div>
            </div>
        </section>

        <div class="tabs-container">
            <button class="tab-btn active" onclick="abrirTab(event, 'tab-anuncios')">Gerenciar An√∫ncios</button>
            <button class="tab-btn" onclick="abrirTab(event, 'tab-feed')">Criar Publica√ß√£o</button>
            <button class="tab-btn" onclick="abrirTab(event, 'tab-portfolio')">Portf√≥lio</button>
            <button class="tab-btn" onclick="abrirTab(event, 'tab-avaliacoes')">Avalia√ß√µes</button>
        </div>

        <div id="tab-anuncios" class="tab-content active">
            <div class="painel-stats-geral">
                <div class="card-kpi"><span>Visualiza√ß√µes Totais</span><h3>12.4K</h3></div>
                <div class="card-kpi"><span>Cliques no Perfil</span><h3>850</h3></div>
                <div class="card-kpi"><h3>4.2%</h3><small class="text-danger">-1%</small></div>
            </div>
            <div class="charts-grid">
                <div class="chart-card"><h4>Desempenho</h4><div class="canvas-container"><canvas id="graficoDesempenho"></canvas></div></div>
                <div class="chart-card"><h4>Origem</h4><div class="canvas-container"><canvas id="graficoOrigem"></canvas></div></div>
            </div>
            <h3 class="titulo-sessao">Meus An√∫ncios Ativos</h3>
            <div id="lista-meus-anuncios"></div>
        </div>

        <div id="tab-feed" class="tab-content">
            <div class="box-criar-post">
                <div class="topo-criar">
                    <img src="https://i.pravatar.cc/150?img=11" class="avatar-mini">
                    <textarea placeholder="O que voc√™ realizou hoje? Compartilhe com seus clientes..."></textarea>
                </div>
                <div class="bottom-criar">
                    <div class="opcoes-midia">
                        <button class="btn-midia foto"><i class='bx bx-image'></i> Foto</button>
                        <button class="btn-midia video"><i class='bx bx-video'></i> V√≠deo</button>
                        <button class="btn-midia story"><i class='bx bx-history'></i> Add Story</button>
                    </div>
                    <button class="btn-publicar">Publicar</button>
                </div>
            </div>
            <h3 class="titulo-sessao" style="margin-top:30px;">Suas Publica√ß√µes Recentes</h3>
            <div class="post-feed-card">
                <div class="header-post">
                    <div class="user-post">
                        <img src="https://i.pravatar.cc/150?img=11">
                        <div><strong>Carlos El√©trica</strong><span>Publicado h√° 2 horas</span></div>
                    </div>
                    <i class='bx bx-dots-horizontal-rounded'></i>
                </div>
                <p class="legenda-post">Finalizando mais um quadro de distribui√ß√£o no bairro Pituba. Seguran√ßa em primeiro lugar! ‚ö° #eletrica #obra</p>
                <div class="midia-post"><img src="https://images.unsplash.com/photo-1621905252507-b35492cc74b4?q=80&w=800"></div>
                <div class="stats-post"><span><i class='bx bx-heart'></i> 45 curtidas</span><span><i class='bx bx-show'></i> 1.2k visualiza√ß√µes</span></div>
            </div>
        </div>

        <div id="tab-portfolio" class="tab-content">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                <h3 class="titulo-sessao" style="margin:0;">Meus Projetos (6)</h3>
                <button class="btn-solid" style="padding: 8px 20px; font-size:0.85rem;"><i class='bx bx-plus'></i> Adicionar Projeto</button>
            </div>
            <div class="portfolio-grid">
                <div class="card-portfolio">
                    <img src="https://images.unsplash.com/photo-1565514020125-3c3f25c898c5?q=80&w=400" class="portfolio-thumb">
                    <div class="portfolio-body">
                        <div class="portfolio-tags"><span class="tag-pf">Residencial</span><span class="tag-pf">Ilumina√ß√£o</span></div>
                        <h4>Reforma Apto Jardins</h4><p>Troca completa de fia√ß√£o e instala√ß√£o de spots de LED inteligentes.</p>
                    </div>
                    <div class="portfolio-footer"><small><i class='bx bx-calendar'></i> Out 2023</small><button class="btn-ver-projeto">Ver Detalhes</button></div>
                </div>
                <div class="card-portfolio">
                    <img src="https://images.unsplash.com/photo-1544724569-5f546fd6dd2d?q=80&w=400" class="portfolio-thumb">
                    <div class="portfolio-body">
                        <div class="portfolio-tags"><span class="tag-pf">Comercial</span><span class="tag-pf">Seguran√ßa</span></div>
                        <h4>Quadro de Distribui√ß√£o</h4><p>Organiza√ß√£o e montagem de quadro industrial para padaria.</p>
                    </div>
                    <div class="portfolio-footer"><small><i class='bx bx-calendar'></i> Set 2023</small><button class="btn-ver-projeto">Ver Detalhes</button></div>
                </div>
                <div class="card-portfolio">
                    <img src="https://images.unsplash.com/photo-1621905251189-08b45d6a269e?q=80&w=400" class="portfolio-thumb">
                    <div class="portfolio-body">
                        <div class="portfolio-tags"><span class="tag-pf">Reparo</span><span class="tag-pf">Urg√™ncia</span></div>
                        <h4>Reparo Chuveiro El√©trico</h4><p>Instala√ß√£o de chuveiro 220v com aterramento adequado.</p>
                    </div>
                    <div class="portfolio-footer"><small><i class='bx bx-calendar'></i> Ago 2023</small><button class="btn-ver-projeto">Ver Detalhes</button></div>
                </div>
            </div>
        </div>
        
<div id="tab-avaliacoes" class="tab-content">
            <h3 class="titulo-sessao">Resumo das Avalia√ß√µes</h3>
            <div class="avaliacao-container">
                <div class="avaliacao-header">
                    <div class="criterios-badge">Crit√©rios</div>
                    <div class="notas-header"><span>√ìtimo</span><span>Bom</span><span>Regular</span><span>Ruim</span><span>P√©ssimo</span></div>
                </div>

                <div class="avaliacao-row">
                    <div class="tooltip-msgs">
                        <h4>üí¨ Coment√°rios sobre Pontualidade:</h4>
                        <div class="msg-item">"Sempre chega 10 minutos antes, excelente!"</div>
                        <div class="msg-item">"Cumpriu o hor√°rio combinado perfeitamente."</div>
                        <div class="msg-item">"Teve um pequeno atraso, mas avisou antes."</div>
                    </div>
                    <div class="criterio-nome">
                        <svg class="icon-criterio" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>Pontualidade
                    </div>
                    <div class="barras-grupo">
                        <div class="barra-item"><span class="num">34</span><div class="progress"><div class="fill" style="width: 80%"></div></div></div>
                        <div class="barra-item"><span class="num">24</span><div class="progress"><div class="fill" style="width: 60%"></div></div></div>
                        <div class="barra-item"><span class="num">6</span><div class="progress"><div class="fill" style="width: 20%"></div></div></div>
                        <div class="barra-item"><span class="num">2</span><div class="progress"><div class="fill" style="width: 10%"></div></div></div>
                        <div class="barra-item"><span class="num">0</span><div class="progress"><div class="fill" style="width: 0%"></div></div></div>
                    </div>
                </div>

                <div class="avaliacao-row">
                    <div class="tooltip-msgs">
                        <h4>üí¨ Sobre Profissionalismo:</h4>
                        <div class="msg-item">"Muito educado e focado no trabalho."</div>
                        <div class="msg-item">"Trouxe todos os equipamentos necess√°rios."</div>
                    </div>
                    <div class="criterio-nome">
                        <svg class="icon-criterio" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="7" width="20" height="14" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></svg>Profissionalismo
                    </div>
                    <div class="barras-grupo">
                        <div class="barra-item"><span class="num">34</span><div class="progress"><div class="fill" style="width: 80%"></div></div></div>
                        <div class="barra-item"><span class="num">24</span><div class="progress"><div class="fill" style="width: 60%"></div></div></div>
                        <div class="barra-item"><span class="num">6</span><div class="progress"><div class="fill" style="width: 20%"></div></div></div>
                        <div class="barra-item"><span class="num">2</span><div class="progress"><div class="fill" style="width: 10%"></div></div></div>
                        <div class="barra-item"><span class="num">0</span><div class="progress"><div class="fill" style="width: 0%"></div></div></div>
                    </div>
                </div>

                <div class="avaliacao-row">
                    <div class="tooltip-msgs">
                        <h4>üí¨ Qualidade do Servi√ßo:</h4>
                        <div class="msg-item">"O acabamento ficou perfeito."</div>
                        <div class="msg-item">"Material de primeira qualidade."</div>
                    </div>
                    <div class="criterio-nome">
                        <svg class="icon-criterio" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></svg>Qualidade
                    </div>
                    <div class="barras-grupo">
                        <div class="barra-item"><span class="num">34</span><div class="progress"><div class="fill" style="width: 80%"></div></div></div>
                        <div class="barra-item"><span class="num">24</span><div class="progress"><div class="fill" style="width: 60%"></div></div></div>
                        <div class="barra-item"><span class="num">6</span><div class="progress"><div class="fill" style="width: 20%"></div></div></div>
                        <div class="barra-item"><span class="num">2</span><div class="progress"><div class="fill" style="width: 10%"></div></div></div>
                        <div class="barra-item"><span class="num">0</span><div class="progress"><div class="fill" style="width: 0%"></div></div></div>
                    </div>
                </div>

                <div class="avaliacao-row">
                    <div class="tooltip-msgs">
                        <h4>üí¨ Sobre o Pre√ßo:</h4>
                        <div class="msg-item">"Pre√ßo justo pelo servi√ßo realizado."</div>
                        <div class="msg-item">"Or√ßamento transparente, sem surpresas."</div>
                    </div>
                    <div class="criterio-nome">
                        <svg class="icon-criterio" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>Valor
                    </div>
                    <div class="barras-grupo">
                        <div class="barra-item"><span class="num">34</span><div class="progress"><div class="fill" style="width: 80%"></div></div></div>
                        <div class="barra-item"><span class="num">24</span><div class="progress"><div class="fill" style="width: 60%"></div></div></div>
                        <div class="barra-item"><span class="num">6</span><div class="progress"><div class="fill" style="width: 20%"></div></div></div>
                        <div class="barra-item"><span class="num">2</span><div class="progress"><div class="fill" style="width: 10%"></div></div></div>
                        <div class="barra-item"><span class="num">0</span><div class="progress"><div class="fill" style="width: 0%"></div></div></div>
                    </div>
                </div>

                <div class="avaliacao-row">
                    <div class="tooltip-msgs">
                        <h4>üí¨ Sobre o Atendimento:</h4>
                        <div class="msg-item">"Muito simp√°tico e prestativo."</div>
                        <div class="msg-item">"Respondeu minhas mensagens rapidamente."</div>
                    </div>
                    <div class="criterio-nome">
                        <svg class="icon-criterio" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>Atendimento
                    </div>
                    <div class="barras-grupo">
                        <div class="barra-item"><span class="num">34</span><div class="progress"><div class="fill" style="width: 80%"></div></div></div>
                        <div class="barra-item"><span class="num">24</span><div class="progress"><div class="fill" style="width: 60%"></div></div></div>
                        <div class="barra-item"><span class="num">6</span><div class="progress"><div class="fill" style="width: 20%"></div></div></div>
                        <div class="barra-item"><span class="num">2</span><div class="progress"><div class="fill" style="width: 10%"></div></div></div>
                        <div class="barra-item"><span class="num">0</span><div class="progress"><div class="fill" style="width: 0%"></div></div></div>
                    </div>
                </div>

                <div id="box-detalhes-criterio">
                    <h4 id="titulo-detalhe">
                        <i class='bx bx-message-detail'></i> Coment√°rios Selecionados
                    </h4>
                    <div id="lista-comentarios-dinamica">
                        </div>
                </div>

                <div class="galeria-posts">
                    <div class="post-card">
                        <div class="user-comment-header">
                            <img src="https://i.pravatar.cc/150?img=32" class="avatar-comment" alt="Foto usu√°rio">
                            <div class="name-comment">Ana Julia<span>Cliente Verificado</span></div>
                        </div>
                        <p class="conteudo-post">"Excelente profissional! Resolveu o curto-circuito em menos de 1 hora. Recomendo muito."</p>
                        <div class="heart-icon">‚ô°</div>
                    </div>
                    <div class="post-card">
                        <div class="user-comment-header">
                            <img src="https://i.pravatar.cc/150?img=13" class="avatar-comment" alt="Foto usu√°rio">
                            <div class="name-comment">Roberto Lima<span>Cliente Verificado</span></div>
                        </div>
                        <p class="conteudo-post">"Pre√ßo justo e servi√ßo limpo. N√£o deixou sujeira nenhuma ap√≥s a instala√ß√£o."</p>
                        <div class="heart-icon">‚ô°</div>
                    </div>
                    <div class="post-card">
                        <div class="user-comment-header">
                            <div class="avatar-comment avatar-anonimo"><i class='bx bx-user'></i></div>
                            <div class="name-comment">Usu√°rio An√¥nimo<span>14/10/2023</span></div>
                        </div>
                        <p class="conteudo-post">"Muito atencioso, explicou todo o processo da instala√ß√£o do quadro novo."</p>
                        <div class="heart-icon">‚ô°</div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <div id="modalEditar" class="modal-overlay">
        <div class="modal-card">
            <div class="modal-header"><h3>Editar Perfil</h3><button onclick="fecharModalEditar()" class="btn-close-modal">√ó</button></div>
            <div class="modal-body">
                <div class="form-group"><label>Nome de Exibi√ß√£o</label><input type="text" id="inputNome" class="input-modal"></div>
                <div class="form-group"><label>Biografia</label><textarea id="inputBio" class="input-modal" rows="3"></textarea></div>
                <div class="form-group"><label>Localiza√ß√£o (Cidade/UF)</label><input type="text" id="inputLoc" class="input-modal"></div>
                <div class="form-group">
                    <label>Foto de Perfil</label>
                    <div class="custom-file-wrapper">
                        <label for="inputFotoFile" class="custom-file-label"><i class='bx bx-camera'></i> Trocar Foto</label>
                        <span id="fotoFileName" class="file-name">Nenhuma selecionada</span>
                        <input type="file" id="inputFotoFile" accept="image/*" style="display:none;">
                        <input type="hidden" id="inputFotoBase64">
                    </div>
                </div>
            </div>
            <div class="modal-footer"><button onclick="fecharModalEditar()" class="btn-cancel">Cancelar</button><button onclick="salvarPerfil()" class="btn-save">Salvar Altera√ß√µes</button></div>
        </div>
    </div>

<div id="modalEditarAnuncio" class="modal-overlay">
        <div class="modal-card" style="max-width: 600px; display: flex; flex-direction: column;">
            
            <div class="modal-header">
                <h3>Gerenciar An√∫ncio</h3>
                <button onclick="fecharModalAnuncio()" class="btn-close-modal">√ó</button>
            </div>

            <div class="modal-body" style="overflow-y: auto; max-height: 70vh;">
                <input type="hidden" id="editAnuncioId">
                <input type="hidden" id="editImg"> <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div class="form-group">
                        <label>T√≠tulo</label>
                        <input type="text" id="editTitulo" class="input-modal">
                    </div>
                    <div class="form-group">
                        <label>Categoria</label>
                        <select id="editCategoria" class="input-modal">
                            <option>Eletricista</option>
                            <option>Encanador</option>
                            <option>Pedreiro</option>
                            <option>Pintor</option>
                            <option>Montador</option>
                            <option>Outros</option>
                        </select>
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div class="form-group">
                        <label>Pre√ßo</label>
                        <input type="text" id="editPreco" class="input-modal">
                    </div>
                    <div class="form-group">
                        <label>Status</label>
                        <select id="editStatus" class="input-modal">
                            <option value="ativo">Ativo</option>
                            <option value="pausado">Pausado</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label>Fotos do Servi√ßo</label>
                    
                    <div id="previewGaleriaModal" class="galeria-modal-container">
                        </div>

                    <div class="custom-file-wrapper">
                        <label for="editImgInput" class="custom-file-label">
                            <i class='bx bx-image-add'></i> Adicionar Foto
                        </label>
                        <span id="fileNameDisplay" class="file-name">Adicione mais fotos...</span>
                        <input type="file" id="editImgInput" accept="image/*" style="display:none;">
                    </div>
                </div>

                <div class="form-group">
                    <label>Local</label>
                    <input type="text" id="editLocal" class="input-modal">
                </div>
                <div class="form-group">
                    <label>Descri√ß√£o</label>
                    <textarea id="editDescricao" class="input-modal" rows="4"></textarea>
                </div>
            </div>

            <div class="modal-footer" style="justify-content: space-between; align-items: center;">
                <a href="editar-anuncio-completo.html" style="font-size:0.9rem; color:var(--cor0); margin-right:auto;">Mais op√ß√µes</a>
                <div style="display: flex; gap: 10px;">
                    <button onclick="excluirAnuncio()" class="btn-cancel" style="color:white; background:#e74c3c;">Excluir</button>
                    <button onclick="salvarAlteracaoAnuncio()" class="btn-save">Salvar</button>
                </div>
            </div>
        </div>
    </div>

    <nav class="bottom-nav">
        <a href="index.html" class="item"><img src="https://cdn-icons-png.flaticon.com/512/1946/1946436.png" class="icon azul"><span>In√≠cio</span></a>
        <a href="meuperfil.html" class="item active"><img src="https://cdn-icons-png.flaticon.com/512/1077/1077114.png" class="icon verde"><span>Perfil</span></a>
    </nav>

    <script>
        // --- 1. L√ìGICA DO PERFIL ---
        document.addEventListener("DOMContentLoaded", () => {
            carregarPerfil();
            renderizarAnuncios();
            iniciarGraficos();
            iniciarAvaliacoes(); // Nova fun√ß√£o para intera√ß√£o
        });

        function carregarPerfil() {
            const usuario = JSON.parse(localStorage.getItem('doke_usuario_perfil')) || {
                nome: "Carlos El√©trica",
                bio: "Especialista em instala√ß√µes residenciais.",
                local: "Salvador, BA",
                foto: "https://i.pravatar.cc/150?img=11"
            };
            
            document.getElementById('nomePerfilDisplay').innerHTML = usuario.nome + " <i class='bx bxs-badge-check'></i>";
            document.getElementById('bioPerfilDisplay').innerText = usuario.bio;
            document.getElementById('locPerfilDisplay').innerHTML = "<i class='bx bx-map'></i> " + usuario.local;
            document.getElementById('fotoPerfilDisplay').src = usuario.foto;
            
            const headerAvatar = document.getElementById('headerAvatar');
            if(headerAvatar) { headerAvatar.src = usuario.foto; headerAvatar.style.display = 'block'; }

            // Preenche modal
            document.getElementById('inputNome').value = usuario.nome;
            document.getElementById('inputBio').value = usuario.bio;
            document.getElementById('inputLoc').value = usuario.local;
            document.getElementById('inputFotoBase64').value = usuario.foto;
        }

        // Upload Foto Perfil
        document.getElementById('inputFotoFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if(file) {
                document.getElementById('fotoFileName').innerText = file.name;
                const reader = new FileReader();
                reader.onload = function(evt) { document.getElementById('inputFotoBase64').value = evt.target.result; };
                reader.readAsDataURL(file);
            }
        });

        function salvarPerfil() {
            const novoPerfil = {
                nome: document.getElementById('inputNome').value,
                bio: document.getElementById('inputBio').value,
                local: document.getElementById('inputLoc').value,
                foto: document.getElementById('inputFotoBase64').value
            };
            localStorage.setItem('doke_usuario_perfil', JSON.stringify(novoPerfil));
            carregarPerfil();
            fecharModalEditar();
            alert("Perfil atualizado!");
        }

        // --- 2. GR√ÅFICOS ---
        function iniciarGraficos() {
            const ctx1 = document.getElementById('graficoDesempenho');
            if(ctx1) {
                new Chart(ctx1, {
                    type: 'line',
                    data: {
                        labels: ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'S√°b', 'Dom'],
                        datasets: [{
                            label: 'Views',
                            data: [12, 19, 3, 5, 2, 3, 10],
                            borderColor: '#0095f6',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: { responsive: true, maintainAspectRatio: false }
                });
            }
            const ctx2 = document.getElementById('graficoOrigem');
            if(ctx2) {
                new Chart(ctx2, {
                    type: 'doughnut',
                    data: {
                        labels: ['Busca', 'Direto'],
                        datasets: [{ data: [70, 30], backgroundColor: ['#0095f6', '#2ecc71'] }]
                    },
                    options: { responsive: true, maintainAspectRatio: false }
                });
            }
        }

        // --- 3. AN√öNCIOS ---
        let meusAnuncios = JSON.parse(localStorage.getItem('doke_anuncios')) || [];
        if(meusAnuncios.length === 0) {
            meusAnuncios = [{id:1, titulo:"Instala√ß√£o El√©trica", status:"ativo", views:"5k", cliques:300, preco:"150,00", img:"https://images.unsplash.com/photo-1621905251189-08b45d6a269e?q=80&w=200"}];
            localStorage.setItem('doke_anuncios', JSON.stringify(meusAnuncios));
        }

        function renderizarAnuncios() {
            const container = document.getElementById('lista-meus-anuncios');
            container.innerHTML = ''; 
            meusAnuncios.forEach(anuncio => {
                let badgeClass = anuncio.status === 'ativo' ? 'ativo' : 'pausado';
                let imgCapa = anuncio.fotos && anuncio.fotos.length > 0 ? anuncio.fotos[0] : (anuncio.img || 'https://placehold.co/100');
                
                const html = `
                    <div class="anuncio-stats-card">
                        <img src="${imgCapa}" class="img-anuncio-mini">
                        <div class="info-anuncio-stats">
                            <div class="topo-anuncio"><h4>${anuncio.titulo}</h4><span class="badge-status ${badgeClass}">${anuncio.status.toUpperCase()}</span></div>
                            <div class="grid-metricas-anuncio">
                                <div class="metrica"><i class='bx bx-show'></i> <strong>${anuncio.views || 0}</strong></div>
                                <div class="metrica"><i class='bx bx-dollar-circle'></i> <strong>${anuncio.preco || anuncio.valor}</strong></div>
                            </div>
                        </div>
                        <div class="acoes-anuncio-stats">
                            <button class="btn-icon-stats" onclick="abrirEditarAnuncio(${anuncio.id})"><i class='bx bx-edit'></i></button>
                        </div>
                    </div>`;
                container.innerHTML += html;
            });
        }

// --- VARI√ÅVEL GLOBAL PARA GERENCIAR FOTOS NA EDI√á√ÉO ---
        let fotosAtuaisEdicao = [];

        // 1. Fun√ß√£o para Abrir o Modal e Carregar Fotos
        function abrirEditarAnuncio(id) {
            const anuncio = meusAnuncios.find(a => a.id === id);
            if(anuncio) {
                // Preenche campos de texto
                document.getElementById('editAnuncioId').value = anuncio.id;
                document.getElementById('editTitulo').value = anuncio.titulo;
                document.getElementById('editPreco').value = anuncio.preco || anuncio.valor;
                document.getElementById('editStatus').value = anuncio.status;
                document.getElementById('editLocal').value = anuncio.local || "";
                document.getElementById('editDescricao').value = anuncio.descricao || "";
                document.getElementById('editCategoria').value = anuncio.categoria || 'Outros';

                // CARREGA AS FOTOS
                // Se tiver array de fotos, usa ele. Se n√£o, usa a img √∫nica.
                if (anuncio.fotos && anuncio.fotos.length > 0) {
                    fotosAtuaisEdicao = [...anuncio.fotos]; // Cria uma c√≥pia para n√£o alterar direto
                } else if (anuncio.img) {
                    fotosAtuaisEdicao = [anuncio.img];
                } else {
                    fotosAtuaisEdicao = [];
                }

                // Renderiza as miniaturas
                renderizarGaleriaEdicao();

                document.getElementById('modalEditarAnuncio').style.display = 'flex';
            }
        }

        // 2. Fun√ß√£o para Desenhar as Miniaturas com o "X"
        function renderizarGaleriaEdicao() {
            const container = document.getElementById('previewGaleriaModal');
            container.innerHTML = ''; // Limpa

            fotosAtuaisEdicao.forEach((fotoBase64, index) => {
                const div = document.createElement('div');
                div.className = 'thumb-wrapper';
                div.innerHTML = `
                    <img src="${fotoBase64}" class="thumb-img">
                    <button class="btn-delete-img" onclick="removerFotoEdicao(${index})">√ó</button>
                `;
                container.appendChild(div);
            });
        }

        // 3. Fun√ß√£o para Remover Foto da Lista
        function removerFotoEdicao(index) {
            fotosAtuaisEdicao.splice(index, 1); // Remove do array tempor√°rio
            renderizarGaleriaEdicao(); // Atualiza visualmente
        }

        // 4. Listener do Input de Arquivo (Adicionar Nova Foto)
        const fileInputAnuncio = document.getElementById('editImgInput');
        if(fileInputAnuncio) {
            fileInputAnuncio.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if(file) {
                    const reader = new FileReader();
                    reader.onload = function(evt) { 
                        // Adiciona a nova foto ao array e renderiza
                        fotosAtuaisEdicao.push(evt.target.result);
                        renderizarGaleriaEdicao();
                        // Reseta o input para poder selecionar a mesma foto se quiser
                        fileInputAnuncio.value = ''; 
                    };
                    reader.readAsDataURL(file);
                }
            });
        }

        // 5. Salvar Altera√ß√µes (Atualizado para salvar o Array)
        function salvarAlteracaoAnuncio() {
            const id = parseInt(document.getElementById('editAnuncioId').value);
            const index = meusAnuncios.findIndex(a => a.id === id);
            
            if(index !== -1) {
                meusAnuncios[index].titulo = document.getElementById('editTitulo').value;
                meusAnuncios[index].preco = document.getElementById('editPreco').value;
                meusAnuncios[index].valor = document.getElementById('editPreco').value;
                meusAnuncios[index].status = document.getElementById('editStatus').value;
                meusAnuncios[index].local = document.getElementById('editLocal').value;
                meusAnuncios[index].descricao = document.getElementById('editDescricao').value;
                meusAnuncios[index].categoria = document.getElementById('editCategoria').value;
                
                // SALVA AS FOTOS
                meusAnuncios[index].fotos = fotosAtuaisEdicao;
                
                // Atualiza a capa (pega a primeira foto ou placeholder)
                if (fotosAtuaisEdicao.length > 0) {
                    meusAnuncios[index].img = fotosAtuaisEdicao[0];
                } else {
                    meusAnuncios[index].img = 'https://placehold.co/200x200?text=Sem+Foto';
                }

                localStorage.setItem('doke_anuncios', JSON.stringify(meusAnuncios));
                renderizarAnuncios();
                fecharModalAnuncio();
                alert("An√∫ncio atualizado!");
            }
        }

        // Fun√ß√µes Auxiliares mantidas
        function fecharModalAnuncio() { document.getElementById('modalEditarAnuncio').style.display = 'none'; }
        
        function excluirAnuncio() {
            if(confirm("Excluir an√∫ncio?")) {
                const id = parseInt(document.getElementById('editAnuncioId').value);
                meusAnuncios = meusAnuncios.filter(a => a.id !== id);
                localStorage.setItem('doke_anuncios', JSON.stringify(meusAnuncios));
                renderizarAnuncios();
                fecharModalAnuncio();
            }
        }

        // --- INTERA√á√ÉO ABAS ---
        function abrirTab(evt, tabName) {
            document.querySelectorAll(".tab-content").forEach(t => t.style.display = "none");
            document.querySelectorAll(".tab-btn").forEach(t => t.classList.remove("active"));
            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.classList.add("active");
        }
        function abrirModalEditar() { document.getElementById('modalEditar').style.display = 'flex'; }
        function fecharModalEditar() { document.getElementById('modalEditar').style.display = 'none'; }

        // Intera√ß√£o de Clique nas Avalia√ß√µes (Restaurado)
        function iniciarAvaliacoes() {
            const rows = document.querySelectorAll('.avaliacao-row');
            rows.forEach(row => {
                row.addEventListener('click', function() {
                    rows.forEach(r => r.classList.remove('selecionado'));
                    this.classList.add('selecionado');
                    const conteudoOculto = this.querySelector('.tooltip-msgs');
                    if (conteudoOculto) {
                        const boxDetalhes = document.getElementById('box-detalhes-criterio');
                        const containerLista = document.getElementById('lista-comentarios-dinamica');
                        const tituloDetalhe = document.getElementById('titulo-detalhe');
                        
                        tituloDetalhe.innerHTML = `<i class='bx bx-comment-detail'></i> ${conteudoOculto.querySelector('h4').innerText}`;
                        containerLista.innerHTML = ''; 
                        conteudoOculto.querySelectorAll('.msg-item').forEach(msg => {
                            const novoCard = document.createElement('div');
                            novoCard.className = 'msg-destaque-item';
                            novoCard.innerHTML = `<i class='bx bxs-quote-alt-left' style='color:#ddd; margin-right:5px;'></i> ${msg.innerText}`;
                            containerLista.appendChild(novoCard);
                        });
                        boxDetalhes.style.display = 'block';
                    }
                });
            });
        }

        window.onclick = function(event) {
            if (event.target == document.getElementById('modalEditar')) fecharModalEditar();
            if (event.target == document.getElementById('modalEditarAnuncio')) fecharModalAnuncio();
        }

        
    </script>
</body>
</html>