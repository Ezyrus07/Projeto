/* ============================================================
   Page - Comunidade (mobile/tablet hardening)
   ============================================================ */

/* Base safety */
body[data-page="comunidade"] main{
  width: 100%;
  max-width: 100%;
  box-sizing: border-box;
}

body[data-page="comunidade"] .comm-layout{
  grid-template-columns: minmax(0, 1fr) !important;
  align-items: start;
}

body[data-page="comunidade"] .comm-sidebar{
  display: none !important;
}

body[data-page="comunidade"] .grid-comunidades{
  width: 100%;
}

body[data-page="comunidade"] .comm-filter-nav{
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 18px;
}

body[data-page="comunidade"] .comm-filter-nav .filter-tabs{
  flex: 1;
  min-width: 0;
  margin-bottom: 0 !important;
}

body[data-page="comunidade"] .comm-filter-arrow{
  width: 38px;
  height: 38px;
  border-radius: 999px;
  border: 1px solid #dfe5ef;
  background: #fff;
  color: var(--cor2);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  flex: 0 0 38px;
  transition: background 0.2s ease, border-color 0.2s ease, opacity 0.2s ease;
}

body[data-page="comunidade"] .comm-filter-arrow:hover{
  background: #f8fbff;
  border-color: #bdd0ea;
}

body[data-page="comunidade"] .comm-filter-arrow:disabled{
  opacity: 0.45;
  cursor: default;
}

body[data-page="comunidade"] .btn-ver-grupo[data-state="entered"]{
  background: #e8f5ee !important;
  border-color: #b8e3cf !important;
  color: #0b7768 !important;
}

body[data-page="comunidade"] .btn-ver-grupo[data-state="request"]{
  background: linear-gradient(90deg, #2f80ed, #0b7768) !important;
  color: #fff !important;
  border-color: transparent !important;
}

body[data-page="comunidade"] .com-card,
body[data-page="comunidade"] .card-comm{
  min-width: 0;
}

body[data-page="comunidade"] .com-title,
body[data-page="comunidade"] .card-title{
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: 1;
  overflow: hidden;
}

body[data-page="comunidade"] .com-desc,
body[data-page="comunidade"] .card-desc{
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: 2;
  overflow: hidden;
}

/* Shell compatibility */
@media (max-width: 1024px){
  body[data-page="comunidade"] .navbar-mobile,
  body[data-page="comunidade"] .bottom-nav,
  body[data-page="comunidade"] #overlay-menu{
    display: none !important;
  }

  body[data-page="comunidade"] main{
    margin-left: 0 !important;
    padding: 18px 14px calc(var(--doke-btm-real, 66px) + 18px + env(safe-area-inset-bottom)) !important;
    padding-top: clamp(12px, 2vw, 22px) !important;
  }

  body[data-page="comunidade"] .comm-hero-container{
    padding: 18px !important;
    border-radius: 18px !important;
    margin: clamp(8px, 1.8vw, 16px) 0 18px !important;
  }

  body[data-page="comunidade"] .comm-header{
    display: grid !important;
    grid-template-columns: 1fr !important;
    gap: 12px !important;
    align-items: start !important;
    margin-bottom: 16px !important;
  }

  body[data-page="comunidade"] .comm-title h1{
    font-size: clamp(1.35rem, 4.4vw, 1.85rem) !important;
    line-height: 1.12 !important;
    margin-bottom: 6px !important;
  }

  body[data-page="comunidade"] .comm-title p{
    font-size: 0.92rem !important;
    line-height: 1.4 !important;
    max-width: 100% !important;
  }

  body[data-page="comunidade"] .header-actions{
    width: 100% !important;
    display: grid !important;
    grid-template-columns: minmax(0, 1fr) auto !important;
    align-items: stretch !important;
    gap: 10px !important;
  }

  body[data-page="comunidade"] .search-bar-comm{
    width: 100% !important;
    min-width: 0 !important;
    height: 44px !important;
    padding: 0 14px !important;
    border-radius: 999px !important;
  }

  body[data-page="comunidade"] .search-bar-comm input{
    font-size: 0.92rem !important;
  }

  body[data-page="comunidade"] .btn-create-comm{
    min-height: 44px !important;
    height: 44px !important;
    padding: 0 14px !important;
    border-radius: 999px !important;
    justify-content: center !important;
    white-space: nowrap !important;
  }

  body[data-page="comunidade"] .my-groups-section{
    margin-top: 4px !important;
  }

  body[data-page="comunidade"] .groups-scroll{
    gap: 10px !important;
    padding-bottom: 6px !important;
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch;
    touch-action: pan-x pan-y !important;
    overscroll-behavior-x: contain;
    scrollbar-width: none;
  }

  body[data-page="comunidade"] .groups-scroll::-webkit-scrollbar{
    display: none;
  }

  body[data-page="comunidade"] .my-group-item{
    min-width: 190px !important;
    width: 190px !important;
    max-width: 190px !important;
    border-radius: 14px !important;
    padding: 9px !important;
    gap: 8px !important;
  }

  body[data-page="comunidade"] .group-img-ring,
  body[data-page="comunidade"] .my-group-cover{
    width: 48px !important;
    height: 48px !important;
    border-radius: 12px !important;
  }

  body[data-page="comunidade"] .my-group-title{
    font-size: 0.86rem !important;
  }

  body[data-page="comunidade"] .my-group-sub{
    font-size: 0.72rem !important;
  }

  body[data-page="comunidade"] .comm-layout{
    grid-template-columns: 1fr !important;
    gap: 14px !important;
  }

  body[data-page="comunidade"] .main-feed-comm{
    min-width: 0 !important;
  }

  body[data-page="comunidade"] .comm-sidebar{
    order: 2;
    min-width: 0 !important;
  }

  body[data-page="comunidade"] .filter-tabs{
    display: flex !important;
    flex-wrap: nowrap !important;
    gap: 8px !important;
    margin-bottom: 14px !important;
    overflow-x: auto !important;
    overflow-y: hidden !important;
    padding-bottom: 4px !important;
    -webkit-overflow-scrolling: touch;
    touch-action: pan-x pan-y !important;
    overscroll-behavior-x: contain;
    scrollbar-width: none;
  }

  body[data-page="comunidade"] .comm-filter-arrow{ display:none !important; }
  body[data-page="comunidade"] .comm-filter-nav .filter-tabs{ padding-left: 0 !important; padding-right: 0 !important; }


  body[data-page="comunidade"] .filter-tabs::-webkit-scrollbar{
    display: none !important;
  }

  body[data-page="comunidade"] .tab-btn{
    flex: 0 0 auto;
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    min-height: 40px !important;
    height: 40px !important;
    padding: 0 14px !important;
    border-radius: 999px !important;
    line-height: 1 !important;
    font-size: 0.84rem !important;
  }

  body[data-page="comunidade"] .grid-comunidades{
    grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
    gap: 12px !important;
  }

  body[data-page="comunidade"] .com-cover,
  body[data-page="comunidade"] .card-cover{
    height: 92px !important;
  }

  body[data-page="comunidade"] .com-body{
    padding: 12px 12px 10px !important;
    gap: 10px !important;
    align-items: flex-start !important;
  }

  body[data-page="comunidade"] .com-avatar{
    width: 54px !important;
    height: 54px !important;
    border-radius: 12px !important;
    margin-top: -26px !important;
    flex: 0 0 54px !important;
  }

  body[data-page="comunidade"] .com-title{
    font-size: 0.98rem !important;
    margin-bottom: 4px !important;
  }

  body[data-page="comunidade"] .com-desc{
    font-size: 0.82rem !important;
    margin-bottom: 8px !important;
  }

  body[data-page="comunidade"] .com-meta{
    gap: 6px !important;
  }

  body[data-page="comunidade"] .pill{
    font-size: 0.66rem !important;
    padding: 5px 8px !important;
  }

  body[data-page="comunidade"] .meta-small{
    font-size: 0.72rem !important;
  }

  body[data-page="comunidade"] .btn-ver-grupo{
    margin-left: 0 !important;
    width: 100% !important;
    min-height: 44px !important;
    border-radius: 10px !important;
    padding: 0 12px !important;
    font-size: 0.82rem !important;
  }

  body[data-page="comunidade"] .btn-ver-grupo[data-state="entered"]{
    background: #e8f5ee !important;
    border-color: #b8e3cf !important;
    color: #0b7768 !important;
  }

  body[data-page="comunidade"] .btn-ver-grupo[data-state="request"]{
    background: linear-gradient(90deg, #2f80ed, #0b7768) !important;
    color: #fff !important;
    border-color: transparent !important;
  }

  body[data-page="comunidade"] .widget-box{
    padding: 16px !important;
    margin-bottom: 12px !important;
    border-radius: 14px !important;
  }

  body[data-page="comunidade"] .widget-title{
    margin-bottom: 12px !important;
    padding-bottom: 8px !important;
    font-size: 0.98rem !important;
  }

  body[data-page="comunidade"] .topic-item{
    gap: 10px !important;
    margin-bottom: 12px !important;
  }

  body[data-page="comunidade"] .topic-icon{
    width: 34px !important;
    height: 34px !important;
    font-size: 1rem !important;
    border-radius: 10px !important;
  }

  body[data-page="comunidade"] .modal-overlay{
    align-items: flex-start !important;
    padding: calc(var(--doke-h, 56px) + 10px) 12px 12px !important;
    z-index: 20050 !important;
  }

  body[data-page="comunidade"] .modal-card{
    width: 100% !important;
    max-width: none !important;
    max-height: calc(100dvh - var(--doke-h, 56px) - 24px) !important;
    overflow: auto !important;
    border-radius: 16px !important;
    padding: 18px !important;
  }
}

@media (min-width: 768px) and (max-width: 1024px){
  body[data-page="comunidade"] .header-actions{
    grid-template-columns: minmax(0, 1fr) auto !important;
  }

  body[data-page="comunidade"] .grid-comunidades{
    grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
  }

  body[data-page="comunidade"] .my-group-item{
    min-width: 210px !important;
    width: 210px !important;
    max-width: 210px !important;
  }
}

@media (max-width: 600px){
  body[data-page="comunidade"] .header-actions{
    grid-template-columns: 1fr !important;
  }

  body[data-page="comunidade"] .btn-create-comm{
    width: 100% !important;
  }

  body[data-page="comunidade"] .grid-comunidades{
    grid-template-columns: 1fr !important;
    gap: 10px !important;
  }

  body[data-page="comunidade"] .com-body{
    display: grid !important;
    grid-template-columns: 50px minmax(0, 1fr) !important;
    gap: 10px !important;
  }

  body[data-page="comunidade"] .com-info{
    min-width: 0 !important;
  }

  body[data-page="comunidade"] .com-meta{
    display: flex !important;
    flex-wrap: wrap !important;
    width: 100% !important;
  }

  body[data-page="comunidade"] .btn-ver-grupo{
    flex: 1 0 100%;
  }
}

@media (max-width: 420px){
  body[data-page="comunidade"] main{
    padding-left: 10px !important;
    padding-right: 10px !important;
  }

  body[data-page="comunidade"] .comm-hero-container{
    padding: 14px !important;
    border-radius: 14px !important;
  }

  body[data-page="comunidade"] .comm-title h1{
    font-size: 1.25rem !important;
  }

  body[data-page="comunidade"] .search-bar-comm{
    height: 42px !important;
  }

  body[data-page="comunidade"] .btn-create-comm{
    min-height: 42px !important;
    height: 42px !important;
    font-size: 0.84rem !important;
  }

  body[data-page="comunidade"] .tab-btn{
    min-height: 38px !important;
    height: 38px !important;
    padding: 0 12px !important;
    font-size: 0.8rem !important;
  }

  body[data-page="comunidade"] .comm-filter-nav{
    gap: 8px;
  }

  body[data-page="comunidade"] .comm-filter-arrow{
    width: 34px;
    height: 34px;
    flex-basis: 34px;
  }

  body[data-page="comunidade"] .my-group-item{
    min-width: 172px !important;
    width: 172px !important;
    max-width: 172px !important;
  }

  body[data-page="comunidade"] .com-cover,
  body[data-page="comunidade"] .card-cover{
    height: 86px !important;
  }
}

/* ============================================================
   Comunidades mobile - estabilidade de scroll/cortes
   ============================================================ */
@media (max-width: 1024px){
  body[data-page="comunidade"] main{
    overflow: visible !important;
    min-height: auto !important;
    -webkit-overflow-scrolling: touch;
    touch-action: pan-y;
    padding-bottom: calc(var(--doke-btm-real, var(--doke-btm, 66px)) + 26px + env(safe-area-inset-bottom)) !important;
  }

  body[data-page="comunidade"] .comm-hero-container{
    margin: 0 0 16px !important;
    width: 100% !important;
  }

  body[data-page="comunidade"] .comm-layout,
  body[data-page="comunidade"] .main-feed-comm,
  body[data-page="comunidade"] .grid-comunidades{
    overflow: visible !important;
  }
}
